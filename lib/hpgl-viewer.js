!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,()=>(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{HPGLViewer:()=>r});var r=function(e){e.container||console.error("Please define a container in options"),e.layerColors||(e.layerColors=["black","red","blue","green","yellow","pink","orange","turquoise"]),e.machineRatio||(e.machineRatio=40);var t,r,n=document.getElementById(e.container),a=n.getContext("2d"),i=function(){n.width=e.canvasWidth,n.height=e.canvasWidth/(e.machineTravelWidth/e.machineTravelHeight),t=n.width,r=n.height};i();var o=function(e){console.log("[HPGL Viewer]",e)},l=function(e){o("Could not parse line:"+e)},c=function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},h=function(n,a){return[n=n/e.machineRatio/(e.machineTravelWidth/t),a=r-a/e.machineRatio/(e.machineTravelHeight/r)]},s=function(e){a.beginPath();var t=h(e[0],e[1]);return a.moveTo(t[0],t[1]),t},f=function(e){for(var t;e.length;){var r=e.splice(0,2),n=h(r[0],r[1]);a.lineTo(n[0],n[1]),t=n}return a.stroke(),t};return{draw:function(n){var i=(n=n.replace(/(\r\n|\n|\r)/gm,"")).split(";"),c=e.layerColors[0],u=[0,0],p=!1;a.clearRect(0,0,t,r),a.lineWidth=.5,a.strokeStyle=c,i.forEach(function(t){var r,n;if(t.length)if((t=t.toUpperCase()).match(/^PU/)){p=!1;var i=t.replace("PU","").split(",");if(i.length<2)return;u=s(i)}else if(t.match(/^PD/)){p=!0;var o=t.replace("PD","").split(",");if(o.length<2)return;u=f(o)}else if(t.match(/^PA/)){var d=t.replace("PA","").split(",");if(d.length<2)return;u=p?f(d):s(d)}else if(t.match(/^AA/)){var v=t.replace("AA","").split(",");if(v.length<3)return void l(t);var m=h(v[0],v[1]),g=v[2]*(Math.PI/180),y=(r=u[0]-m[0],n=u[1]-m[1],Math.hypot(r,n)),P=Math.atan2(u[1]-m[1],u[0]-m[0]);a.beginPath(),a.arc(m[0],m[1],y,P-g,P,!0),a.stroke(),u=m}else if(t.match(/^SP/)){var b=parseInt(t.replace("SP",""))-1;c=b>0?e.layerColors[b]:null,a.strokeStyle=c}else t.match(/^IN/)||t.match(/^VS/)||l(t)}),o("Finished parsing")},setMachineTravelWidth:function(t){c(t)&&(e.machineTravelWidth=t,i())},setMachineTravelHeight:function(t){c(t)&&(e.machineTravelHeight=t,i())}}};return t})());