!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var a in r)("object"==typeof exports?exports:e)[a]=r[a]}}(self,()=>(()=>{"use strict";var e={d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{HPGLViewer:()=>r});var r=function(e){e.container||console.error("Please define a container in options"),e.layerColors||(e.layerColors=["black","red","blue","green","yellow","pink","orange","turquoise"]),e.machineRatio||(e.machineRatio=40);var t,r,a=document.getElementById(e.container),n=a.getContext("2d"),i=function(){a.width=e.canvasWidth,a.height=e.canvasWidth/(e.machineTravelWidth/e.machineTravelHeight),t=a.width,r=a.height};i();var o=function(e){console.log("[HPGL Viewer]",e)},l=function(e){o("Could not parse line:"+e)},c=function(e){if(isNaN(e))return!1;var t=parseFloat(e);return(0|t)===t},h=function(a,n){return[a=a/e.machineRatio/(e.machineTravelWidth/t),n=r-n/e.machineRatio/(e.machineTravelHeight/r)]},s=function(e){n.beginPath();var t=h(e[0],e[1]);return n.moveTo(t[0],t[1]),t},f=function(e){for(var t;e.length;){var r=e.splice(0,2),a=h(r[0],r[1]);n.lineTo(a[0],a[1]),t=a}return n.stroke(),t};return{draw:function(a){var i=(a=a.replace(/(\r\n|\n|\r)/gm,"")).split(";"),c=e.layerColors[0],u=[0,0],p=!1;n.clearRect(0,0,t,r),n.lineWidth=.5,n.strokeStyle=c,i.forEach(function(r){var a,i;if(r.length)if((r=r.toUpperCase()).match(/^PU/)){p=!1;var o=r.replace("PU","").split(",");if(o.length<2)return;u=s(o)}else if(r.match(/^PD/)){p=!0;var v=r.replace("PD","").split(",");if(v.length<2)return;u=f(v)}else if(r.match(/^PA/)){var d=r.replace("PA","").split(",");if(d.length<2)return;u=p?f(d):s(d)}else if(r.match(/^AA/)){var m=r.replace("AA","").split(",");if(m.length<3)return void l(r);var g=h(m[0],m[1]),y=m[2]*(Math.PI/180),P=(a=u[0]-g[0],i=u[1]-g[1],Math.hypot(a,i)),b=Math.atan2(u[1]-g[1],u[0]-g[0]);n.beginPath(),n.arc(g[0],g[1],P,b-y,b,!0),n.stroke(),u=g}else if(r.match(/^CI/)){var T=r.replace("CI","").split(","),S=T[0]/e.machineRatio/(e.machineTravelWidth/t);T[1],n.beginPath(),n.ellipse(u[0],u[1],S,S,0,0,2*Math.PI),n.stroke()}else if(r.match(/^SP/)){var C=parseInt(r.replace("SP",""))-1;c=C>0?e.layerColors[C]:null,n.strokeStyle=c}else r.match(/^IN/)||r.match(/^VS/)||l(r)}),o("Finished parsing")},setMachineTravelWidth:function(t){c(t)&&(e.machineTravelWidth=t,i())},setMachineTravelHeight:function(t){c(t)&&(e.machineTravelHeight=t,i())}}};return t})());